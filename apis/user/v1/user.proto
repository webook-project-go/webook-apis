syntax = "proto3";

option go_package = "github.com/webook-project-go/webook-apis/gen/go/apis/user/v1";

service UserAuthService {
  rpc SignUp(SignUpRequest) returns (SignUpResponse);
  rpc Edit(EditRequest) returns (EditResponse);
  rpc FindUserByEmail(FindUserByEmailRequest) returns (FindUserResponse);
  rpc FindUserById(FindUserByIdRequest) returns (FindUserResponse);
  rpc FindUser(FindUserRequest) returns (FindUserResponse);
  rpc FindOrCreateByPhone(FindOrCreateByPhoneRequest) returns (FindUserResponse);
  rpc Login(LoginRequest) returns (FindUserResponse);
  rpc FindOrCreateOauth2Binding(FindOrCreateOauth2BindingRequest) returns (FindOrCreateOauth2BindingResponse);
}

message User {
  int64 id = 1;
  string email = 2;
  string password = 3;
  string phone = 4;
  string name = 5;
  string birthday = 6;
  string about_me = 7;
}

message Oauth2Binding {
  int64 user_id = 1;
  int64 id = 2;
  string provider = 3;
  string external_id = 4;
  string access_token = 5;
}

message SignUpRequest {
  User user = 1;
}
message SignUpResponse {}

message EditRequest {
  User user = 1;
}
message EditResponse {}

message FindUserByEmailRequest {
  string email = 1;
}
message FindUserByIdRequest {
  int64 id = 1;
}
message FindUserRequest {
  string field = 1;
  string value = 2;
}

message FindUserResponse {
  User user = 1;
}

message FindOrCreateByPhoneRequest {
  string phone = 1;
}

message LoginRequest {
  string email = 1;
  string password = 2;
}

message FindOrCreateOauth2BindingRequest {
  Oauth2Binding binding = 1;
}
message FindOrCreateOauth2BindingResponse {
  Oauth2Binding binding = 1;
}
